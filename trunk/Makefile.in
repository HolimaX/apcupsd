# main Makefile for apcupsd
#
# Copyright (C) 1999-2002 Riccardo Facchetti <riccardo@master.oasi.gpa.it>
#

# Default variables
@VARIABLES@
# TOP source directory.
topdir = @top_srcdir@
top_builddir = $(topdir)

#
# this is a list of all subdirectories that contain Makefiles
# Warning: "autoconf" must always be the last.
# Warning: "platforms" must always be next to last.
#
subdirs = src include examples doc platforms autoconf

# Include the default make targets: to be put before the all-targets: rule.
@TARGETS@

all-targets: Makefile

install: install-directories install-subdirs

install-directories: install-dir@CGI@
	@if [ ! -d /tmp ] ; then \
		$(SHELL) $(MKINSTALLDIRS) /tmp \
		chmod 777 /tmp; \
	fi
	@if [ ! -d $(prefix) ] ; then \
		$(SHELL) $(MKINSTALLDIRS) $(prefix) \
		chmod 755 $(prefix); \
	fi
	@if [ ! -d $(prefix) ] ; then \
		$(SHELL) $(MKINSTALLDIRS) $(prefix) \
		chmod 755 $(prefix); \
	fi
	@if [ ! -d $(sbindir) ] ; then \
		$(SHELL) $(MKINSTALLDIRS) $(sbindir) \
		chmod 755 $(sbindir); \
	fi
	@if [ ! -d $(sysconfdir) ] ; then \
		$(SHELL) $(MKINSTALLDIRS) $(sysconfdir) \
		chmod 755 $(sysconfdir); \
	fi

install-dir: dummy

install-dircgi:
	@$(SHELL) $(MKINSTALLDIRS)  $(cgibin)

uninstall: uninstall-subdirs

clean: targetclean
	$(RMF) `find . -type f -size 0 -print`

distclean: targetdistclean
	$(RMF) TAGS tags
	$(RMF) config.cache config.status config.log config.out stamp-config
	$(RMF) Makefile

# -----------------------------------------------------------------------
# DO NOT DELETE THIS LINE -- make depend depends on it.
