# Makefile template for apcupsd
#
# Copyright (C) 1999-2002 Riccardo Facchetti <riccardo@master.oasi.gpa.it>
#

# Default variables
@VARIABLES@
# TOP source directory.
topdir = @topdir@
top_builddir = $(topdir)

subdirs = @APCSMART_DRIVER@ @DUMB_DRIVER@ @NET_DRIVER@ \
          @USB_DRIVER@ @SNMP_DRIVER@ @TEST_DRIVER@ \
          @PCNET_DRIVER@

# Include the default make targets: to be put before the all-targets: rule.
@TARGETS@

driverslib = libdrivers.a

driversobjs = drivers.o

all-targets: $(driverslib)

@APCSMART_DRIVER@_objs = apcsmart/*.o
@DUMB_DRIVER@_objs = dumb/*.o
@NET_DRIVER@_objs = net/*.o
@USB_DRIVER@_objs = usb/*.o usb/@USB_TYPE@/*.o @LIBUSBHIDOBJS@
@SNMP_DRIVER@_objs = snmp/*.o
@TEST_DRIVER@_objs = test/*.o
@PCNET_DRIVER@_objs = pcnet/*.o
_objs=

$(driverslib): $(driversobjs) @APCSMART_DRIVER@_stamp @DUMB_DRIVER@_stamp @NET_DRIVER@_stamp @USB_DRIVER@_stamp @SNMP_DRIVER@_stamp @TEST_DRIVER@_stamp @PCNET_DRIVER@_stamp drivers_stamp
	rm -f $(driverslib)
	ar cru $(driverslib) $(driversobjs) $(@APCSMART_DRIVER@_objs) $(@DUMB_DRIVER@_objs) $(@NET_DRIVER@_objs) $(@USB_DRIVER@_objs) $(@SNMP_DRIVER@_objs) $(@TEST_DRIVER@_objs) $(@PCNET_DRIVER@_objs) 
	@RANLIB@ $(driverslib)

_stamp:

drivers_stamp: drivers.c
	touch drivers_stamp

apcsmart_stamp: apcsmart/libapcsmart.a
	touch apcsmart_stamp

dumb_stamp: dumb/libdumb.a
	touch dumb_stamp

net_stamp: net/libnet.a
	touch net_stamp

usb_stamp: usb/libusb.a
	touch usb_stamp

snmp_stamp: snmp/libsnmp.a
	touch snmp_stamp

test_stamp: test/libtest.a
	touch test_stamp

pcnet_stamp: pcnet/libpcnet.a
	touch pcnet_stamp

clean: targetclean
	$(RMF) *_stamp

distclean: targetdistclean
	$(RMF) Makefile
	$(RMF) -r CVS apcsmart/CVS dumb/CVS net/CVS snmp/CVS test/CVS usb/CVS

# -----------------------------------------------------------------------
# DO NOT DELETE THIS LINE -- make depend depends on it.
